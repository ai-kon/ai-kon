<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì¼“ì»¬ë¦¬ - ìƒˆë²½ë°°ì†¡, ì „êµ­ë°°ì†¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
        }
        .kurly-purple {
            background-color: #5F0080;
        }
        .kurly-btn {
            background-color: #5F0080;
            color: white;
        }
        .kurly-btn:hover {
            background-color: #7C1BA1;
        }
        .product-card:hover {
            transform: translateY(-5px);
            transition: all 0.3s;
        }
        .dawn-badge {
            background: linear-gradient(135deg, #5F0080 0%, #9B59B6 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-6xl mx-auto bg-white min-h-screen">
        <!-- Header -->
        <div class="kurly-purple text-white p-4 sticky top-0 z-50">
            <div class="flex items-center justify-between">
                <button onclick="window.location.href='../'" class="text-2xl">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h1 class="text-2xl font-bold">ë§ˆì¼“ì»¬ë¦¬</h1>
                <div class="flex space-x-4">
                    <button onclick="toggleCart()" class="relative">
                        <i class="fas fa-shopping-cart text-xl"></i>
                        <span id="cartCount" class="absolute -top-2 -right-2 bg-white text-purple-700 text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold">0</span>
                    </button>
                    <button>
                        <i class="fas fa-user text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Dawn Delivery Banner -->
        <div class="dawn-badge text-white p-4 text-center">
            <p class="text-lg font-bold">â° ìƒ›ë³„ë°°ì†¡ â°</p>
            <p class="text-sm">ë°¤ 11ì‹œ ì „ ì£¼ë¬¸ì‹œ ë‚´ì¼ ì•„ì¹¨ 7ì‹œ ì „ ë„ì°©</p>
        </div>

        <!-- Search Bar -->
        <div class="p-4 bg-white border-b">
            <div class="flex items-center bg-gray-100 rounded-lg px-4 py-3">
                <i class="fas fa-search text-gray-400 mr-3"></i>
                <input type="text" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" class="bg-transparent flex-1 outline-none" id="searchInput" oninput="filterProducts()">
            </div>
        </div>

        <!-- Categories -->
        <div class="overflow-x-auto border-b bg-white">
            <div class="flex p-4 space-x-2 whitespace-nowrap">
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-700 bg-purple-700 text-white font-bold" onclick="filterCategory('ì „ì²´')">ì „ì²´</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('ì±„ì†Œ')">ì±„ì†Œ</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('ê³¼ì¼')">ê³¼ì¼</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('ìœ¡ë¥˜')">ìœ¡ë¥˜</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('í•´ì‚°ë¬¼')">í•´ì‚°ë¬¼</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('ìœ ì œí’ˆ')">ìœ ì œí’ˆ</button>
                <button class="category-btn px-4 py-2 rounded-full border-2 border-purple-300 text-purple-700 font-bold" onclick="filterCategory('ë² ì´ì»¤ë¦¬')">ë² ì´ì»¤ë¦¬</button>
            </div>
        </div>

        <!-- Products Grid -->
        <div id="productsContainer" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4 bg-gray-50">
            <!-- Products will be populated here -->
        </div>

        <!-- Cart Modal -->
        <div id="cartModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50">
            <div class="absolute right-0 top-0 bottom-0 w-full md:w-96 bg-white">
                <div class="kurly-purple p-4 flex justify-between items-center">
                    <h2 class="text-xl font-bold text-white">ì¥ë°”êµ¬ë‹ˆ</h2>
                    <button onclick="toggleCart()" class="text-2xl text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="cartItems" class="overflow-y-auto p-4" style="height: calc(100vh - 220px);">
                    <!-- Cart items will be populated here -->
                </div>
                <div class="absolute bottom-0 left-0 right-0 p-4 border-t bg-white">
                    <div class="mb-3 space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>ìƒí’ˆê¸ˆì•¡</span>
                            <span id="subtotal">0ì›</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>ë°°ì†¡ë¹„</span>
                            <span id="deliveryFee">3,000ì›</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg border-t pt-2">
                            <span>ì´ ê¸ˆì•¡</span>
                            <span id="totalPrice" class="text-purple-700">0ì›</span>
                        </div>
                    </div>
                    <button class="w-full kurly-btn py-4 rounded-lg font-bold">
                        ì£¼ë¬¸í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- Product Detail Modal -->
        <div id="productModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto">
            <div class="min-h-screen flex items-center justify-center p-4">
                <div class="bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto">
                    <div class="kurly-purple p-4 flex justify-between items-center sticky top-0">
                        <h2 class="text-xl font-bold text-white">ìƒí’ˆ ìƒì„¸</h2>
                        <button onclick="closeProductModal()" class="text-2xl text-white">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="productDetail" class="p-6">
                        <!-- Product detail will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const products = [
            { id: 1, name: 'GAP ì¸ì¦ ìœ ê¸°ë† ìƒëŸ¬ë“œ', category: 'ì±„ì†Œ', price: 4900, image: 'ğŸ¥—', rating: 4.9, reviews: 2345, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 2, name: 'ì œì£¼ ë¬´ë†ì•½ ê°ê·¤', category: 'ê³¼ì¼', price: 12900, image: 'ğŸŠ', rating: 4.8, reviews: 5678, fresh: true, dawn: true, origin: 'ì œì£¼' },
            { id: 3, name: 'êµ­ë‚´ì‚° í•œìš° ë“±ì‹¬ 1ë“±ê¸‰', category: 'ìœ¡ë¥˜', price: 38900, image: 'ğŸ¥©', rating: 4.9, reviews: 1234, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 4, name: 'ì œì£¼ í™œì „ë³µ', category: 'í•´ì‚°ë¬¼', price: 29900, image: 'ğŸš', rating: 4.7, reviews: 890, fresh: true, dawn: true, origin: 'ì œì£¼' },
            { id: 5, name: 'ì„œìš¸ìš°ìœ  1000ml', category: 'ìœ ì œí’ˆ', price: 3200, image: 'ğŸ¥›', rating: 4.8, reviews: 8765, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 6, name: 'ìœ ê¸°ë† ë°©ìš¸í† ë§ˆí† ', category: 'ì±„ì†Œ', price: 8900, image: 'ğŸ…', rating: 4.7, reviews: 3456, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 7, name: 'ì¹œí™˜ê²½ ì²­ê²½ì±„', category: 'ì±„ì†Œ', price: 3500, image: 'ğŸ¥¬', rating: 4.6, reviews: 1234, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 8, name: 'ì• í”Œë§ê³  2ì…', category: 'ê³¼ì¼', price: 19900, image: 'ğŸ¥­', rating: 4.8, reviews: 2345, fresh: true, dawn: true, origin: 'í˜ë£¨ì‚°' },
            { id: 9, name: 'êµ­ë‚´ì‚° ë¼ì§€ê³ ê¸° ì‚¼ê²¹ì‚´', category: 'ìœ¡ë¥˜', price: 15900, image: 'ğŸ¥“', rating: 4.8, reviews: 4567, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 10, name: 'ì†ì§ˆ ìƒˆìš°ì‚´ 300g', category: 'í•´ì‚°ë¬¼', price: 12900, image: 'ğŸ¦', rating: 4.6, reviews: 2890, fresh: true, dawn: true, origin: 'ë² íŠ¸ë‚¨ì‚°' },
            { id: 11, name: 'ìƒí•˜ëª©ì¥ ìœ ê¸°ë† ìš°ìœ ', category: 'ìœ ì œí’ˆ', price: 4500, image: 'ğŸ„', rating: 4.9, reviews: 6789, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 12, name: 'íŒŒë¦¬ë°”ê²Œëœ¨ ì‹ë¹µ', category: 'ë² ì´ì»¤ë¦¬', price: 4200, image: 'ğŸ', rating: 4.7, reviews: 3456, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 13, name: 'ì¹œí™˜ê²½ ì‹œê¸ˆì¹˜', category: 'ì±„ì†Œ', price: 2900, image: 'ğŸ¥¬', rating: 4.5, reviews: 1890, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 14, name: 'ì™„ìˆ™ ì•„ë³´ì¹´ë„ 3ì…', category: 'ê³¼ì¼', price: 8900, image: 'ğŸ¥‘', rating: 4.7, reviews: 2345, fresh: true, dawn: true, origin: 'í˜ë£¨ì‚°' },
            { id: 15, name: 'êµ­ë‚´ì‚° ë‹­ê°€ìŠ´ì‚´', category: 'ìœ¡ë¥˜', price: 9900, image: 'ğŸ—', rating: 4.8, reviews: 5678, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 16, name: 'ì œì£¼ ì€ê°ˆì¹˜', category: 'í•´ì‚°ë¬¼', price: 32900, image: 'ğŸŸ', rating: 4.9, reviews: 1234, fresh: true, dawn: true, origin: 'ì œì£¼' },
            { id: 17, name: 'ê·¸ë¦­ ìš”ê±°íŠ¸', category: 'ìœ ì œí’ˆ', price: 5900, image: 'ğŸ¥£', rating: 4.8, reviews: 3456, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 18, name: 'í¬ë£¨ì•„ìƒ 4ì…', category: 'ë² ì´ì»¤ë¦¬', price: 7900, image: 'ğŸ¥', rating: 4.6, reviews: 2345, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 19, name: 'GAP íŒŒí”„ë¦¬ì¹´', category: 'ì±„ì†Œ', price: 6900, image: 'ğŸ«‘', rating: 4.7, reviews: 1567, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 20, name: 'ì¹ ë ˆì‚° ë¸”ë£¨ë² ë¦¬', category: 'ê³¼ì¼', price: 11900, image: 'ğŸ«', rating: 4.6, reviews: 2890, fresh: true, dawn: true, origin: 'ì¹ ë ˆì‚°' },
            { id: 21, name: 'êµ­ë‚´ì‚° í•œìš° ë¶ˆê³ ê¸°ìš©', category: 'ìœ¡ë¥˜', price: 28900, image: 'ğŸ¥©', rating: 4.9, reviews: 3456, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 22, name: 'ê´‘ì–´íšŒ 300g', category: 'í•´ì‚°ë¬¼', price: 19900, image: 'ğŸ¡', rating: 4.8, reviews: 1890, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 23, name: 'ë§¤ì¼ìœ ì—… ë°”ë‚˜ë‚˜ë§› ìš°ìœ ', category: 'ìœ ì œí’ˆ', price: 2800, image: 'ğŸŒ', rating: 4.7, reviews: 9876, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 24, name: 'ì†Œê¸ˆë¹µ 6ì…', category: 'ë² ì´ì»¤ë¦¬', price: 8900, image: 'ğŸ¥–', rating: 4.8, reviews: 4567, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 25, name: 'ìœ ê¸°ë† ë¸Œë¡œì½œë¦¬', category: 'ì±„ì†Œ', price: 4500, image: 'ğŸ¥¦', rating: 4.6, reviews: 2345, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 26, name: 'ìƒ¤ì¸ë¨¸ìŠ¤ìº£', category: 'ê³¼ì¼', price: 24900, image: 'ğŸ‡', rating: 4.9, reviews: 3456, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 27, name: 'êµ­ë‚´ì‚° ê³„ë€ 30êµ¬', category: 'ìœ ì œí’ˆ', price: 8900, image: 'ğŸ¥š', rating: 4.8, reviews: 7890, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 28, name: 'ë² ì´ê¸€ ëª¨ìŒ 6ì…', category: 'ë² ì´ì»¤ë¦¬', price: 9900, image: 'ğŸ¥¯', rating: 4.7, reviews: 2345, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 29, name: 'ì¹œí™˜ê²½ ë‹¹ê·¼', category: 'ì±„ì†Œ', price: 3200, image: 'ğŸ¥•', rating: 4.5, reviews: 1234, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 30, name: 'ìº ë²¨ í¬ë„', category: 'ê³¼ì¼', price: 9900, image: 'ğŸ‡', rating: 4.6, reviews: 1890, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 31, name: 'êµ­ë‚´ì‚° ë¼ì§€ ì•ë‹¤ë¦¬', category: 'ìœ¡ë¥˜', price: 12900, image: 'ğŸ¥“', rating: 4.7, reviews: 2345, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 32, name: 'ìƒì—°ì–´ íšŒ 200g', category: 'í•´ì‚°ë¬¼', price: 16900, image: 'ğŸŸ', rating: 4.8, reviews: 3456, fresh: true, dawn: true, origin: 'ë…¸ë¥´ì›¨ì´ì‚°' },
            { id: 33, name: 'ë– ë¨¹ëŠ” ìš”ê±°íŠ¸ 500g', category: 'ìœ ì œí’ˆ', price: 4200, image: 'ğŸ¥›', rating: 4.7, reviews: 5678, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 34, name: 'ì¹˜ì•„ë°”íƒ€ ë¹µ', category: 'ë² ì´ì»¤ë¦¬', price: 5900, image: 'ğŸ¥–', rating: 4.6, reviews: 1567, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 35, name: 'êµ­ë‚´ì‚° ì–‘íŒŒ 3ì…', category: 'ì±„ì†Œ', price: 4500, image: 'ğŸ§…', rating: 4.5, reviews: 2890, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 36, name: 'ì²­ì†¡ ì‚¬ê³¼', category: 'ê³¼ì¼', price: 14900, image: 'ğŸ', rating: 4.8, reviews: 4567, fresh: true, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 37, name: 'ëª©ìš°ì´Œ ì†Œì‹œì§€', category: 'ìœ¡ë¥˜', price: 7900, image: 'ğŸŒ­', rating: 4.6, reviews: 3456, fresh: false, dawn: true, origin: 'êµ­ë‚´ì‚°' },
            { id: 38, name: 'ëƒ‰ë™ í°ë‹¤ë¦¬ ìƒˆìš°', category: 'í•´ì‚°ë¬¼', price: 18900, image: 'ğŸ¦', rating: 4.7, reviews: 2345, fresh: false, dawn: true, origin: 'ë² íŠ¸ë‚¨ì‚°' },
        ];

        let cart = JSON.parse(localStorage.getItem('kurlyCart') || '[]');
        let currentCategory = 'ì „ì²´';

        function init() {
            renderProducts();
            updateCartCount();
        }

        function renderProducts() {
            const container = document.getElementById('productsContainer');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = products.filter(p => {
                const matchCategory = currentCategory === 'ì „ì²´' || p.category === currentCategory;
                const matchSearch = p.name.toLowerCase().includes(searchTerm);
                return matchCategory && matchSearch;
            });

            container.innerHTML = filtered.map(product => `
                <div class="product-card bg-white rounded-lg overflow-hidden shadow-md cursor-pointer" onclick="showProductDetail(${product.id})">
                    ${product.dawn ? '<div class="dawn-badge text-white text-xs font-bold px-2 py-1 absolute m-2">ìƒ›ë³„ë°°ì†¡</div>' : ''}
                    <div class="aspect-square bg-gray-50 flex items-center justify-center text-6xl">
                        ${product.image}
                    </div>
                    <div class="p-3">
                        <p class="text-sm font-semibold line-clamp-2">${product.name}</p>
                        <div class="flex items-center mt-2 text-xs text-gray-500">
                            <i class="fas fa-star text-yellow-400"></i>
                            <span class="ml-1">${product.rating}</span>
                            <span class="ml-2">(${product.reviews})</span>
                        </div>
                        <p class="text-lg font-bold mt-2">${product.price.toLocaleString()}ì›</p>
                        ${product.fresh ? '<span class="inline-block text-xs bg-green-100 text-green-700 px-2 py-1 rounded mt-2">ì‹ ì„ ë³´ì¥</span>' : ''}
                        <button onclick="addToCart(${product.id}); event.stopPropagation();"
                                class="w-full mt-3 kurly-btn py-2 rounded text-sm font-bold">
                            <i class="fas fa-cart-plus"></i> ë‹´ê¸°
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);

            document.getElementById('productDetail').innerHTML = `
                <div class="aspect-square bg-gray-50 flex items-center justify-center text-9xl mb-6 relative">
                    ${product.dawn ? '<div class="dawn-badge text-white text-sm font-bold px-3 py-2 absolute top-4 left-4">ìƒ›ë³„ë°°ì†¡</div>' : ''}
                    ${product.image}
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="text-2xl font-bold">${product.name}</h3>
                        <p class="text-sm text-gray-500 mt-1">${product.origin}</p>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-star text-yellow-400"></i>
                        <span class="ml-1 font-bold">${product.rating}</span>
                        <span class="ml-2 text-gray-500">ë¦¬ë·° ${product.reviews}ê°œ</span>
                    </div>
                    <p class="text-3xl font-bold text-purple-700">${product.price.toLocaleString()}ì›</p>
                    ${product.fresh ? `
                        <div class="bg-green-50 p-3 rounded-lg border-2 border-green-200">
                            <p class="text-green-700 font-bold">âœ“ ì‹ ì„ ë³´ì¥</p>
                            <p class="text-sm text-green-600 mt-1">100% ì‹ ì„ í•œ ìƒí’ˆìœ¼ë¡œ ë°°ì†¡ë©ë‹ˆë‹¤</p>
                        </div>
                    ` : ''}
                    ${product.dawn ? `
                        <div class="bg-purple-50 p-3 rounded-lg border-2 border-purple-200">
                            <p class="text-purple-700 font-bold">â° ìƒ›ë³„ë°°ì†¡ ê°€ëŠ¥</p>
                            <p class="text-sm text-purple-600 mt-1">ë°¤ 11ì‹œ ì „ ì£¼ë¬¸ì‹œ ë‚´ì¼ ì•„ì¹¨ 7ì‹œ ì „ ë„ì°©</p>
                        </div>
                    ` : ''}
                    <div>
                        <label class="block font-bold mb-2">ìˆ˜ëŸ‰</label>
                        <div class="flex items-center">
                            <button class="border px-4 py-2 rounded-l" onclick="decreaseQty()">-</button>
                            <input type="number" id="quantity" value="1" min="1" class="border-t border-b w-16 text-center py-2" readonly>
                            <button class="border px-4 py-2 rounded-r" onclick="increaseQty()">+</button>
                        </div>
                    </div>
                    <button onclick="addToCartWithQty(${product.id})"
                            class="w-full kurly-btn py-4 rounded-lg font-bold text-lg">
                        ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°
                    </button>
                    <div class="border-t pt-4 space-y-2 text-sm">
                        <p><strong>ì›ì‚°ì§€:</strong> ${product.origin}</p>
                        <p><strong>ë°°ì†¡:</strong> ${product.dawn ? 'ìƒ›ë³„ë°°ì†¡ (ë°¤ 11ì‹œ ì „ ì£¼ë¬¸)' : 'ì¼ë°˜ë°°ì†¡'}</p>
                        <p><strong>ë°°ì†¡ë¹„:</strong> 3,000ì› (40,000ì› ì´ìƒ ë¬´ë£Œ)</p>
                        <p><strong>ì•ˆë‚´ì‚¬í•­:</strong> ì‹ ì„ ì‹í’ˆ íŠ¹ì„±ìƒ ë°°ì†¡ í›„ êµí™˜/ë°˜í’ˆ ë¶ˆê°€</p>
                    </div>
                </div>
            `;
            document.getElementById('productModal').classList.remove('hidden');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.add('hidden');
        }

        function increaseQty() {
            const input = document.getElementById('quantity');
            input.value = parseInt(input.value) + 1;
        }

        function decreaseQty() {
            const input = document.getElementById('quantity');
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
            }
        }

        function filterCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('border-purple-700', 'bg-purple-700', 'text-white');
                btn.classList.add('border-purple-300', 'text-purple-700');
            });
            event.target.classList.add('border-purple-700', 'bg-purple-700', 'text-white');
            event.target.classList.remove('border-purple-300', 'text-purple-700');
            renderProducts();
        }

        function filterProducts() {
            renderProducts();
        }

        function addToCart(productId) {
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id: productId, quantity: 1 });
            }
            localStorage.setItem('kurlyCart', JSON.stringify(cart));
            updateCartCount();
            renderCart();
        }

        function addToCartWithQty(productId) {
            const qty = parseInt(document.getElementById('quantity').value);
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += qty;
            } else {
                cart.push({ id: productId, quantity: qty });
            }
            localStorage.setItem('kurlyCart', JSON.stringify(cart));
            updateCartCount();
            closeProductModal();
            alert('ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•˜ìŠµë‹ˆë‹¤!');
        }

        function toggleCart() {
            document.getElementById('cartModal').classList.toggle('hidden');
            renderCart();
        }

        function renderCart() {
            const container = document.getElementById('cartItems');
            if (cart.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-10">ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤</p>';
                document.getElementById('subtotal').textContent = '0ì›';
                document.getElementById('totalPrice').textContent = '0ì›';
                return;
            }

            let subtotal = 0;
            container.innerHTML = cart.map(item => {
                const product = products.find(p => p.id === item.id);
                subtotal += product.price * item.quantity;
                return `
                    <div class="border-b pb-4 mb-4">
                        <div class="flex items-center">
                            <div class="w-20 h-20 bg-gray-50 flex items-center justify-center text-3xl mr-3 rounded">
                                ${product.image}
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-semibold">${product.name}</p>
                                ${product.dawn ? '<p class="text-xs text-purple-600 font-bold">ìƒ›ë³„ë°°ì†¡</p>' : ''}
                                <p class="text-sm font-bold mt-1 text-purple-700">${product.price.toLocaleString()}ì›</p>
                                <div class="flex items-center mt-2">
                                    <button onclick="updateCartQuantity(${product.id}, -1)" class="border px-2 py-1 text-sm rounded">-</button>
                                    <span class="px-3 font-bold">${item.quantity}</span>
                                    <button onclick="updateCartQuantity(${product.id}, 1)" class="border px-2 py-1 text-sm rounded">+</button>
                                    <button onclick="removeFromCart(${product.id})" class="ml-auto text-purple-600 text-sm">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            const deliveryFee = subtotal >= 40000 ? 0 : 3000;
            const total = subtotal + deliveryFee;

            document.getElementById('subtotal').textContent = subtotal.toLocaleString() + 'ì›';
            document.getElementById('deliveryFee').textContent = deliveryFee === 0 ? 'ë¬´ë£Œ' : deliveryFee.toLocaleString() + 'ì›';
            document.getElementById('totalPrice').textContent = total.toLocaleString() + 'ì›';
        }

        function updateCartQuantity(productId, change) {
            const item = cart.find(i => i.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    localStorage.setItem('kurlyCart', JSON.stringify(cart));
                    updateCartCount();
                    renderCart();
                }
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('kurlyCart', JSON.stringify(cart));
            updateCartCount();
            renderCart();
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        init();
    </script>
</body>
</html>
